apiVersion: apps/v1
kind: Deployment
metadata:
  name: geolocation-service-deployment
  labels:
    app: geo-deploy
spec:
  containers:
    - name: app
      image: nginx
      ports:
        - containerPort: 8080
      volumeMounts:
        - name: secrets-store01-inline
          mountPath: "/mnt/secrets-store"
          readOnly: true
      env:
        - name: APIClientSecret
          valueFrom:
            secretKeyRef:
              name: k8s-secret
              key: pAPI-ClientSecret
        - name: APIClientId
          valueFrom:
            secretKeyRef:
              name: k8s-secret
              key: API-ClientId
  volumes:
    - name: secrets-store01-inline
      csi:
        driver: secrets-store.csi.k8s.io
        readOnly: true
        volumeAttributes:
          secretProviderClass: "azure-spc-name"
